(my["webpackJsonp"]=my["webpackJsonp"]||[]).push([["pages/index/index"],{"0634":function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=a(i("a34a"));function a(t){return t&&t.__esModule?t:{default:t}}function r(t,e,i,n,a,r,o){try{var s=t[r](o),c=s.value}catch(u){return void i(u)}s.done?e(c):Promise.resolve(c).then(n,a)}function o(t){return function(){var e=this,i=arguments;return new Promise(function(n,a){var o=t.apply(e,i);function s(t){r(o,n,a,s,c,"next",t)}function c(t){r(o,n,a,s,c,"throw",t)}s(void 0)})}}var s={name:"luckyWheel",data:function(){return{easejoyBean:0,lotteryTicket:0,did:"",prizeList:[{icon:"../../static/activity/bean_500.png",count:50,name:"PRA",isPrize:1},{icon:"../../static/activity/bean_one.png",count:15,name:"PRA",isPrize:1},{icon:"../../static/activity/bean_five.png",count:20,name:"PRA",isPrize:1},{icon:"../../static/activity/point_five.png",count:5,name:"PRA",isPrize:1},{icon:"../../static/activity/point_ten.png",count:10,name:"PRA",isPrize:1},{icon:"../../static/activity/bean_500.png",count:30,name:"PRA",isPrize:1},{icon:"../../static/activity/give_up.png",count:0,name:"未中奖",isPrize:0},{icon:"../../static/activity/bean_500.png",count:40,name:"PRA",isPrize:1}],toastControl:!1,hasPrize:!1,startRotatingDegree:0,rotateAngle:0,startRotatingDegreePointer:0,rotateAnglePointer:0,rotateTransition:"transform 6s ease-in-out",rotateTransitionPointer:"transform 12s ease-in-out",clickFlag:!0,index:0}},mounted:function(){var e=this;this.$nextTick(o(n.default.mark(function i(){var a;return n.default.wrap(function(i){while(1)switch(i.prev=i.next){case 0:try{a=e,e.initPrizeList(),t.getAuthCode({provider:"alipay",scopes:"auth_user",success:function(e){console.log(e),t.getAuthUserInfo({provider:"alipay",success:function(t){var e="/api/v1/mainnet/decode_avatar",i={avatar:t.avatar.replace(/\d+$/,0)};a.$api.apipost(e,i,"get").then(function(t){var e=t.data.result;a.did=e;var i="/api/v1/lottery/records",n={did:a.did};a.$api.apipost(i,n,"get").then(function(t){var e=t.data.list;a.did&&0===e.length&&(a.lotteryTicket=1)})})}})}})}catch(n){console.log(n)}case 1:case"end":return i.stop()}},i,this)})))},computed:{toastTitle:function(){return this.hasPrize?"恭喜您，获得"+this.prizeList[this.index].count+" "+this.prizeList[this.index].name:"未中奖"},toastPictrue:function(){return this.hasPrize?i("1f25"):i("284e")}},methods:{initPrizeList:function(){var t=o(n.default.mark(function t(){var e,i,a=this;return n.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:e="/api/v1/lottery/gifts",i={},this.$api.apipost(e,i,"get").then(function(t){var e=t.data.list;a.prizeList=a.prizeList.map(function(t,i){var n=e[i],a=n.id,r=n.name,o=n.reward;return r=r.replace("PRA","").replace("未中奖",""),t.id=a,t.count=r,t.reward=o,t}),console.log(a.prizeList,"prize list")});case 3:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),rotateHandle:function(){var e=o(n.default.mark(function e(){var i,a,r=this;return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.did){e.next=2;break}return e.abrupt("return",t.showToast({title:"没有检测到您的DID，无法参与抽奖",icon:"none"}));case 2:i="/api/v1/lottery/draw",a={did:this.did},this.$api.apipost(i,a,"get").then(function(e){var i=e;if(i.hasErrors)t.showToast({title:i.message,duration:2e3,icon:"none"});else{var n=i.data.id;r.index=n-1,r.rotating()}});case 5:case"end":return e.stop()}},e,this)}));function i(){return e.apply(this,arguments)}return i}(),rotating:function(){if(this.clickFlag){var t=0,e=5,i=this.index,n=[337.5,292.5,247.5,202.5,157.5,112.5,67.5,22.5],a=6;if(this.clickFlag=!1,0===t){var r=this.startRotatingDegree+360*a+n[i]-this.startRotatingDegree%360;this.startRotatingDegree=r,this.rotateAngle="rotate("+r+"deg)";var o=this;setTimeout(function(){o.clickFlag=!0,o.gameOver()},1e3*e+1500)}}},gameOver:function(){this.toastControl=!0,this.hasPrize=this.prizeList[this.index].isPrize,this.lotteryTicket=0},closeToast:function(){this.toastControl=!1}}};e.default=s}).call(this,i("c11b")["default"])},"2fc7":function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement;t._self._c},a=[];i.d(e,"a",function(){return n}),i.d(e,"b",function(){return a})},"4a1c":function(t,e,i){"use strict";var n=i("801a"),a=i.n(n);a.a},"801a":function(t,e,i){},"852c":function(t,e,i){"use strict";(function(t){i("cc16"),i("921b");n(i("66fd"));var e=n(i("92a7"));function n(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,i("c11b")["createPage"])},"92a7":function(t,e,i){"use strict";i.r(e);var n=i("2fc7"),a=i("caaf");for(var r in a)"default"!==r&&function(t){i.d(e,t,function(){return a[t]})}(r);i("4a1c");var o=i("2877"),s=Object(o["a"])(a["default"],n["a"],n["b"],!1,null,"760fabc1",null);e["default"]=s.exports},caaf:function(t,e,i){"use strict";i.r(e);var n=i("0634"),a=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);e["default"]=a.a}},[["852c","common/runtime","common/vendor"]]]);